<div class="main-content">
  <div class="card-container">
    <h2 class="mb-4 text-center text-primary">Elenco Squadre</h2>

    <ul class="list-group mb-4">
      <li *ngFor="let squadra of squadre" class="list-group-item d-flex justify-content-between align-items-center">
        <div class="d-flex flex-column">
          <strong class="text-dark">{{ squadra.name }}</strong>
          <small class="text-muted">Atlete IDs: {{ squadra.id_atlete.join(', ') }}</small>
        </div>

        <div class="d-flex gap-2 align-items-center">
          <button class="btn btn-link text-primary p-0" (click)="apriEditorSquadra(squadra)" title="Modifica squadra">
            âœï¸
          </button>
          <button class="btn btn-link text-danger p-0" (click)="chiediConfermaEliminazione(squadra)"
            title="Elimina squadra">
            ğŸ—‘ï¸
          </button>
        </div>
      </li>
    </ul>

    <button class="btn btn-outline-primary w-100 mb-3" (click)="showForm = !showForm">
      {{ showForm ? 'Annulla' : 'â• Aggiungi Squadra' }}
    </button>

    <div *ngIf="showForm" class="position-relative">
      <input [(ngModel)]="nuovaSquadra.name" class="form-control mb-3" placeholder="Nome squadra" />
      <button class="btn btn-info mb-3" (click)="toggleAtletaList()">ğŸ‘€ Mostra Atlete</button>
      <div *ngIf="showAtleteList" class="atlete-list-box">
        <h5 class="mb-2 text-center">Seleziona Atlete</h5>
        <div class="list-group">
          <button *ngFor="let atleta of elencoAtlete" class="list-group-item list-group-item-action"
            [class.active]="isSelected(atleta._id)" (click)="toggleAtletaSelection(atleta._id)">
            {{ atleta.name }} {{ atleta.lastname }}
          </button>
        </div>
      </div>

      <button class="btn btn-success w-100 mt-3" (click)="aggiungiSquadra()">âœ… Salva</button>
    </div>

    <div *ngIf="showEditor" class="card p-3 mt-4 border border-primary-subtle rounded">
      <h5 class="mb-3 text-primary text-center">Modifica squadra: {{ squadraDaModificare.name }}</h5>

      <div class="list-group mb-3">
        <button *ngFor="let atleta of elencoAtlete"
          class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
          [class.active]="atletaSelezionatoSingolo?._id === atleta._id" (click)="selezionaAtletaSingolo(atleta)">
          {{ atleta.name }} {{ atleta.lastname }}
        </button>
      </div>

      <div *ngIf="atletaSelezionatoSingolo" class="alert alert-info text-center">
        Selezionato: <strong>{{ atletaSelezionatoSingolo.name }} {{ atletaSelezionatoSingolo.lastname }}</strong><br>
        <small>{{ messaggioErrore }}</small>
      </div>

      <div class="d-flex justify-content-between">
        <button class="btn btn-outline-success w-100 me-2" (click)="aggiungiAtletaSingolo()">â• Aggiungi</button>
        <button class="btn btn-outline-danger w-100 ms-2" (click)="rimuoviAtletaSingolo()">â– Rimuovi</button>
      </div>

      <div class="d-flex justify-content-between mt-3">
        <button class="btn btn-secondary" (click)="showEditor = false">Annulla</button>
        <button class="btn btn-success" (click)="caricaSquadre(); showEditor = false">ğŸ”„ Aggiorna</button>
      </div>
    </div>
  </div>

  <div *ngIf="showConfirmDelete" class="modal-overlay">
    <div class="modal-box">
      <h5>Conferma Eliminazione</h5>
      <p>Sei sicuro di voler eliminare la squadra <strong>{{ squadraDaEliminare?.name }}</strong>?</p>
      <div class="d-flex justify-content-end gap-2">
        <button class="btn btn-secondary" (click)="annullaEliminazione()">Annulla</button>
        <button class="btn btn-danger" (click)="confermaEliminazione()">Conferma</button>
      </div>
    </div>
  </div>
</div>
